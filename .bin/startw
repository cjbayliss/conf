#!/bin/sh
# real smooth scrolling in FF
# FIXME: is this needed under sway?
export MOZ_USE_XINPUT2=1

# ibus input stuff
export GTK_IM_MODULE=ibus
export XMODIFIERS=@im=ibus
export QT_IM_MODULE=ibus

# set QT theme engine. requires qt5ct -_-
export QT_QPA_PLATFORMTHEME="qt5ct"

# wayland stuff
export QT_QPA_PLATFORM=wayland
export GDK_BACKEND=wayland
export QT_WAYLAND_DISABLE_WINDOWDECORATION="1"

# XDG_*_DIRs
export XDG_DESKTOP_DIR="$HOME/dev"
export XDG_DOCUMENTS_DIR="$HOME/dev"
export XDG_DOWNLOAD_DIR="$HOME/downloads"
export XDG_MUSIC_DIR="$HOME/music"
export XDG_VIDEOS_DIR="$HOME/videos"

if test -z "${XDG_RUNTIME_DIR}"; then
    export XDG_RUNTIME_DIR=/tmp/${UID}-runtime-dir
    if ! test -d "${XDG_RUNTIME_DIR}"; then
        mkdir "${XDG_RUNTIME_DIR}"
        chmod 0700 "${XDG_RUNTIME_DIR}"
    fi
fi

if ! test -d "$HOME/.local/tmp/sway/"; then
    mkdir -p "$HOME/.local/tmp/sway/"
fi

# Now start sway! :)
exec dbus-launch --sh-syntax --exit-with-session sway 2>"$HOME/.local/tmp/sway/$(date '+%F')-$(date|md5sum - | cut -d' ' -f1).log"
